---
import BaseLayout from '../../layouts/BaseLayout.astro';

const title = 'Work';
const description = 'all work and no play makes jack a dull boy.';
const permalink = `${Astro.site.href}work`;

let allPosts = await Astro.glob('../../data/work/*.{md,mdx}');
allPosts = allPosts.sort((a, b) => parseInt(b.frontmatter.id))
---

<style>

  h2,
  .post-item-footer {
    font-weight: 700;
  }

  .post-item-date {
    color: var(--text-secondary);
    text-align: left;
    text-transform: uppercase;
    margin-right: 16px;
  }

  hr {
    margin: 60px auto;
  }

  .flex-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: left;
    gap: 4rem;
  }
    .flex-container > article {
      width: 30rem;
      flex-shrink: 0;
      flex-grow: 1;
      flex-basis: auto;
    }

  .thumbnail {
    display: block;
    width: 100%;
    height: 20rem;
    overflow: none;
    background-color: transparent;
    background-repeat: no-repeat;
  }

  .card:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transform: translateY(-5px);
    transition: all 0.3s ease;
  }

</style>

<BaseLayout title={title} description={description} permalink={permalink} current="work">
  <div class="row row-cols-1 row-cols-md-2 g-4">
    {allPosts.map((post, index) => {
      const href = (post.frontmatter.direct_link && post.frontmatter.direct_link !== '') ? post.frontmatter.direct_link : `/work/${post.file.split('/').pop().split('.').shift()}`;
      const target = (post.frontmatter.direct_link && post.frontmatter.direct_link !== '') ? '_blank' : '_self';
      const tags = post.frontmatter.tags.split(', ');
      const thumbnail = `/assets/work/${post.frontmatter.thumbnail}`;
      
      return (
        <div class="col">
          <div class="card h-100">
            <div class="overflow-hidden thumbnail border-none">
              <img src={thumbnail} class="img-fluid mx-auto d-block" alt={post.frontmatter.description}>
            </div>
            <div class="card-body">
              <h5 class="card-title">{post.frontmatter.title}</h5>
              <p class="card-text">{post.frontmatter.description}</p>
              <a href={href} target={target} class="stretched-link">Read more</a>
            </div>
            <div class="card-footer">
              <small class="text-body-secondary">
                { tags.map(t => ( <span class="badge rounded-pill text-bg-light">{t}</span> ) )}
              </small>
            </div>
          </div>
        </div>
      )
    })}
  </div>
</BaseLayout>
